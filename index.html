<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <script src="https://code.jquery.com/jquery-3.4.1.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.0.272/jspdf.debug.js"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="/styles.css" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css"
      integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB"
      crossorigin="anonymous"
    />

    <style>
      .header {
        text-align: center;

        /* text-transform: uppercase; */
        /* letter-spacing: 1px; */
        padding: 20px;
        margin: 0%;
        font-family: 'Changa One', cursive;
        font-size: 20px;
        text-shadow: 4px 4px 4px rgb(134, 133, 133);
        /* font-family: 'Bad Script', cursive; */
        font-family: 'Fredericka the Great', cursive;
      }
      .time {
        margin: 0%;
        padding: 5px;
      }
      .teddy {
        padding-left: 15px;
      }
      .expance {
        padding-left: 15px;
      }
      .download{
        padding-left: 25px;
      }
      .time{
        padding-left: 15px;
      }
      .header{
        padding-left: 15px;      
      }
    </style>

    <title>Mehaber</title>
  </head>

  <link
    rel="stylesheet"
    href="https://fonts.googleapis.com/css?family=Tangerine"
  />

  <link
    href="https://fonts.googleapis.com/css?family=Roboto&display=swap"
    rel="stylesheet"
  />
  <link
    href="https://fonts.googleapis.com/css?family=Bad+Script|Roboto&display=swap"
    rel="stylesheet"
  />

  <link
    href="https://fonts.googleapis.com/css?family=Bad+Script|Fredericka+the+Great|Roboto&display=swap"
    rel="stylesheet"
  />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link
    rel="stylesheet"
    href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css"
  />

  <body onload="myFunction()">
    <div class="time">
      <div class="row">
        <div class="time" class="col">
          <p class="text-primary">Date/Time: <span id="datetime"></span></p>
        </div>
        <div class="header" class="col">
          <h1 class="header">Individual Monthly Contribution</h1>
        </div>
      </div>
      <div class="active-cyan-3 active-cyan-4 mb-4" class="col">
        <input
          class="form-control"
          type="text"
          id="myInput"
          onkeyup="search()"
          placeholder="Search by Year.. 2019"
          title="Type in a name"
        />
      </div>
    </div>

    <script>
      var dt = new Date();
      document.getElementById('datetime').innerHTML = dt.toLocaleString();
    </script>

    <!-- <button type="button" id="loadData">Load JSON</button> -->
    <div id="output"></div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <!-- <script src="/app.js"></script> -->
    <script>
      function myFunction() {
        $(function myFunction() {
          $(function() {
            var url =
              'https://spreadsheets.google.com/feeds/list/1wiq5A0xNJNDkpCtlksCRf6Hs19tWH7HsB1zQ3iQnEc8/od6/public/values?alt=json';
            $.getJSON(url, function(data) {
              console.log(data.feed.entry);
              console.log(data);

              var html = '';
              $.each(data.feed.entry, function(key, val) {
                html += `



                  <div class="container">

                  <!--###################START HERE#####################-->

                  <!-- TABLE -->

                  <table id="customers" class="table table-striped table-bordered table-hover table-sm">
                  <thead class="table-primary">
                  <tr>
                      <th style="width:75px"><font color="#3d3dff "><i>${val.gsx$members.$t}</font></th>
                      <th>Total</th>
                      <th><font color="#540316"><b>${val.gsx$grandtotal.$t}</th>
                  </tr>
              </thead>


                      <thead class="table-primary">
                          <tr>

                              <th>Year</th>
                              <th>Jan</th>
                              <th>Feb</th>
                              <th>Mar</th>
                              <th>Apr</th>
                              <th>May</th>
                              <th>Jun</th>
                              <th>Jul</th>
                              <th>Aug</th>
                              <th>Sept</th>
                              <th>Oct</th>
                              <th>Nov</th>
                              <th>Dec</th>
                              <th><font color="#540316"><b>Total</th>
                          </tr>
                      </thead>
                      <tbody>
                          <tr>

                          <td>${val.gsx$year.$t}</td>
                          <td>${val.gsx$jan.$t}</td>
                          <td>${val.gsx$feb.$t}</td>
                          <td>${val.gsx$mar.$t}</td>
                          <td>${val.gsx$apr.$t}</td>
                          <td>${val.gsx$may.$t}</td>
                          <td>${val.gsx$jun.$t}</td>
                          <td>${val.gsx$jul.$t}</td>
                          <td>${val.gsx$aug.$t}</td>
                          <td>${val.gsx$sep.$t}</td>
                          <td>${val.gsx$oct.$t}</td>
                          <td>${val.gsx$nov.$t}</td>
                          <td>${val.gsx$dec.$t}</td>
                          <td><font color="#540316"><b>${val.gsx$total.$t}</td>
                          </tr>
                          <tr>

                              <td>${val.gsx$year_2.$t}</td>
                              <td>${val.gsx$jan_2.$t}</td>
                              <td>${val.gsx$feb_2.$t}</td>
                              <td>${val.gsx$mar_2.$t}</td>
                              <td>${val.gsx$apr_2.$t}</td>
                              <td>${val.gsx$may_2.$t}</td>
                              <td>${val.gsx$jun_2.$t}</td>
                              <td>${val.gsx$jul_2.$t}</td>
                              <td>${val.gsx$aug_2.$t}</td>
                              <td>${val.gsx$sep_2.$t}</td>
                              <td>${val.gsx$oct_2.$t}</td>
                              <td>${val.gsx$nov_2.$t}</td>
                              <td>${val.gsx$dec_2.$t}</td>
                              <td><font color="#540316"><b>${val.gsx$total_2.$t}</td>
                          </tr>

                          <tr>
                            <td>${val.gsx$year_3.$t}</td>
                            <td>${val.gsx$jan_3.$t}</td>
                            <td>${val.gsx$feb_3.$t}</td>
                            <td>${val.gsx$mar_3.$t}</td>
                            <td>${val.gsx$apr_3.$t}</td>
                            <td>${val.gsx$may_3.$t}</td>
                            <td>${val.gsx$jun_3.$t}</td>
                            <td>${val.gsx$jul_3.$t}</td>
                            <td>${val.gsx$aug_3.$t}</td>
                            <td>${val.gsx$sep_3.$t}</td>
                            <td>${val.gsx$oct_3.$t}</td>
                            <td>${val.gsx$nov_3.$t}</td>
                            <td>${val.gsx$dec_3.$t}</td>
                            <td><font color="#540316"><b>${val.gsx$total_3.$t}</td>
                          </tr>
                      </tbody>
                  </table>

              </div>



                  `;
              });
              $('#output').html(html);
            });
          });
        });
      }
    </script>
    <div class="teddy">
      <table
        id="Expance"
        class="table table-striped table-bordered table-hover table-sm"
      >
        <thead class="table-primary">
          <tr>
            <th>Teddy</th>
            <th>Contribution</th>
            <th>Reason</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>1</td>
            <td>$140.00</td>
            <td>7 payments (2017 monthly contribution)</td>
          </tr>
          <tr>
            <td>2</td>
            <td>$320.00</td>
            <td>4 payments for trip to Costa Rica</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="expance">
      <table
        id="Expance"
        class="table table-striped table-bordered table-hover table-sm"
      >
        <thead class="table-primary">
          <tr>
            <td>Date</td>
            <td>Expanse</td>
            <td>Reason</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>6/17/2017</td>
            <td>-$265.00</td>
            <td>አዲስ አበባ Restaurant (Roha Band)</td>
          </tr>
        </tbody>

        <tbody>
          <tr>
            <td>9/23/2017</td>
            <td>-$120.00</td>
            <td>(Ben T.) Mayweather vs McGregor</td>
          </tr>
          <tr>
            <td>9/23/2017</td>
            <td>-$84.00</td>
            <td>(Ben M.) Mayweather vs McGregor</td>
          </tr>
          <tr>
            <td>11/12/2017</td>
            <td>-$355.00</td>
            <td>Portico Hookah Lounge</td>
          </tr>
          <tr>
            <td>12/9/2017</td>
            <td>-$786.60</td>
            <td>ደስታ Restaurant</td>
          </tr>
          <tr>
            <td>11/17/2018</td>
            <td>-$366.04</td>
            <td>Addis Ababa food catering for Wondem</td>
          </tr>
          <tr>
            <td>5/26/2019</td>
            <td>-$500.00</td>
            <td>Elbe's Graduation</td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="download">
      <!-- <p>
          Download your statement:
          <button
            type="button"
            class="btn btn-default btn-sm"
            onclick="makePDF()"
          >
            <span class="glyphicon glyphicon-cloud-download"></span> Download from
            Cloud
          </button>
        </p> -->

      <p>
        Download your statement:
        <a href="#" class="btn btn-info btn-md" onclick="makePDF()">
          <span class="glyphicon glyphicon-cloud-download"></span>
          Download your statement
        </a>
      </p>
    </div>

    <script>
      function makePDF() {
        let doc = new jsPDF('p', 'mm', [400, 1400]);
        var d = new Date().toGMTString();

        doc.addHTML(document.body, function() {
          doc.save('መሀበር_Statement_' + d + '.pdf');
        });
      }
      function search() {
        var input, filter, table, tr, td, i, txtValue;
        input = document.getElementById('myInput');
        filter = input.value.toUpperCase();
        table = document.getElementById('output');
        tr = table.getElementsByTagName('tr');
        for (i = 0; i < tr.length; i++) {
          td = tr[i].getElementsByTagName('td')[0];
          if (td) {
            txtValue = td.textContent || td.innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
              tr[i].style.display = '';
            } else {
              tr[i].style.display = 'none';
            }
          }
        }
      }
    </script>
  </body>
</html>
